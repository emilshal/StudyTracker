<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Study Tracker</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <h1>Study Tracker</h1>
        <p class="tagline">Log study sessions, visualize progress, stay consistent.</p>
      </div>
      <div class="app-nav-container" data-auth-visible="true">
        <nav class="app-nav" role="tablist">
          <button type="button" class="app-nav__btn active" data-view="dashboard" role="tab" aria-selected="true">
            Dashboard
          </button>
          <button type="button" class="app-nav__btn" data-view="history" role="tab">
            History
          </button>
          <button type="button" class="app-nav__btn" data-view="log" role="tab">
            Subjects
          </button>
          <button type="button" class="app-nav__btn" data-view="trends" role="tab">
            Trends
          </button>
        </nav>
        <button type="button" class="secondary logout-btn" id="logout-btn">Logout</button>
      </div>
    </header>

    <main>
      <section class="view" data-view="auth" aria-label="Authentication" data-auth-hidden="true">
        <section class="card auth-card">
          <div>
            <h2>Welcome back</h2>
            <p class="history-subtitle">Sign in to access your study analytics.</p>
          </div>
          <form id="login-form" class="auth-form">
            <h3>Sign In</h3>
            <label>
              Email
              <input type="email" id="login-email" required />
            </label>
            <label>
              Password
              <input type="password" id="login-password" required minlength="8" />
            </label>
            <button type="submit">Login</button>
            <p id="login-error" class="form-message hidden"></p>
            <button type="button" class="link-button" id="show-register-btn">
              Donâ€™t have an account? Sign up
            </button>
          </form>

          <form id="register-form" class="auth-form hidden">
            <h3>Create Account</h3>
            <label>
              Email
              <input type="email" id="register-email" required />
            </label>
            <label>
              Password
              <input type="password" id="register-password" required minlength="8" />
            </label>
            <button type="submit">Register</button>
            <p class="auth-note">Password must be at least 8 characters.</p>
            <p id="register-error" class="form-message hidden"></p>
            <button type="button" class="link-button" id="show-login-btn">
              Already have an account? Sign in
            </button>
          </form>

          <div class="auth-divider">
            <span>or</span>
          </div>
          <p class="tagline">Use your email and password to sign in.</p>
        </section>
      </section>

      <section class="view active" data-view="dashboard" aria-label="Dashboard">
        <section class="card live-track-card live-track-card--full" aria-labelledby="live-track-title">
          <div class="live-track-hero">
            <h2 id="live-track-title">Live Track</h2>
            <p class="live-track-subtitle">Tap start, stay focused, and let the tracker log the rest.</p>
          </div>
          <div class="live-track-circle" id="live-track-circle">
            <button
              type="button"
              class="live-track-trigger"
              id="live-track-trigger"
              aria-pressed="false"
              aria-expanded="false"
            >
              <span>Track Live</span>
            </button>
            <div class="live-track-timer-display hidden" id="live-track-timer-wrapper" aria-live="polite">
              <span id="live-track-timer">00:00:00</span>
            </div>
          </div>
          <p id="live-track-status" class="live-track-status">Tap Track Live to begin.</p>
          <div class="live-track-mode hidden" id="live-track-mode">
            <p class="live-track-mode-hint">Choose how you want to focus.</p>
            <div class="live-track-mode-options">
              <button type="button" data-live-track-mode="stopwatch">
                <strong>Stopwatch</strong>
                <span>Count up and log whenever you're done.</span>
              </button>
              <button type="button" data-live-track-mode="timer">
                <strong>Timer</strong>
                <span>Set a countdown and log at zero.</span>
              </button>
            </div>
          </div>
          <div class="live-track-setup hidden" id="live-track-setup">
            <div class="live-track-setup-header">
              <span class="live-track-selected-mode hidden" id="live-track-selected-mode">Stopwatch</span>
              <button
                type="button"
                class="link-button live-track-change-mode hidden"
                id="live-track-change-mode"
              >
                Change
              </button>
            </div>
            <label>
              Subject
              <input
                type="text"
                id="live-track-subject"
                placeholder="Choose or create a subject"
                list="subjects"
                autocomplete="off"
                required
              />
              <div class="subject-suggestions" id="live-track-suggestions" hidden></div>
            </label>
            <label class="live-track-color">
              Color
              <input type="color" id="live-track-color" value="#6366f1" />
            </label>
            <label class="live-track-duration hidden" id="live-track-duration-wrapper">
              Duration (minutes)
              <input
                type="text"
                inputmode="numeric"
                pattern="[0-9]*"
                id="live-track-duration"
                value="25"
                placeholder="e.g. 25"
              />
            </label>
            <button type="button" id="live-track-start">Start</button>
          </div>
          <div class="live-track-controls hidden" id="live-track-controls">
            <button type="button" class="secondary" id="live-track-pause" disabled>Pause</button>
            <button type="button" id="live-track-log" disabled>Save</button>
          </div>
          <p id="live-track-message" class="form-message hidden"></p>
        </section>
        <div class="streak-chip" id="streak-chip" aria-live="polite">
          <span class="streak-icon" aria-hidden="true">ðŸ”¥</span>
          <span class="streak-text"><strong id="streak-count">0</strong> day streak</span>
        </div>
      </section>

      <section class="view" data-view="log" aria-label="Subjects">
        <div class="layout layout-subjects">
          <section class="card subjects-manager" aria-labelledby="subjects-title">
            <div class="subject-manager-header">
              <div>
                <h2 id="subjects-title">Subjects</h2>
                <p class="subject-list-subtitle">
                  Add, update, or remove subjectsâ€”all changes flow into live tracking, manual logging, and charts.
                </p>
              </div>
              <div class="subject-list-controls">
                <label class="sr-only" for="subject-search">Search subjects</label>
                <input type="search" id="subject-search" placeholder="Search by name" autocomplete="off" />
                <button type="button" class="secondary" id="subject-refresh">Refresh</button>
              </div>
            </div>

            <form id="subject-form" class="subject-form subjects-manager-form">
              <input type="hidden" id="subject-id" />
              <div class="subject-form-grid">
                <label>
                  Name
                  <input type="text" id="subject-name" placeholder="e.g. Mathematics" required />
                </label>
                <label>
                  Color
                  <input type="color" id="subject-color" value="#6366f1" />
                </label>
              </div>
              <div class="subject-quick-palette" id="subject-palette">
                <span>Quick colors:</span>
                <div class="subject-quick-palette__colors">
                  <button type="button" class="subject-quick-color" data-color="#6366f1" style="--subject-color:#6366f1" aria-label="Select #6366f1"></button>
                  <button type="button" class="subject-quick-color" data-color="#38bdf8" style="--subject-color:#38bdf8" aria-label="Select #38bdf8"></button>
                  <button type="button" class="subject-quick-color" data-color="#f472b6" style="--subject-color:#f472b6" aria-label="Select #f472b6"></button>
                  <button type="button" class="subject-quick-color" data-color="#facc15" style="--subject-color:#facc15" aria-label="Select #facc15"></button>
                  <button type="button" class="subject-quick-color" data-color="#34d399" style="--subject-color:#34d399" aria-label="Select #34d399"></button>
                  <button type="button" class="subject-quick-color" data-color="#f97316" style="--subject-color:#f97316" aria-label="Select #f97316"></button>
                  <button type="button" class="subject-quick-color" data-color="#22d3ee" style="--subject-color:#22d3ee" aria-label="Select #22d3ee"></button>
                  <button type="button" class="subject-quick-color" data-color="#a855f7" style="--subject-color:#a855f7" aria-label="Select #a855f7"></button>
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" id="subject-submit">Add Subject</button>
                <button type="button" id="subject-cancel" class="secondary hidden">Cancel</button>
              </div>
              <p id="subject-error" class="form-message hidden"></p>
            </form>

            <ul id="subjects-list" class="subjects-list"></ul>
          </section>
        </div>
      </section>

      <section class="view" data-view="history" aria-label="Study History">
        <section class="card history-card">
          <div class="history-header">
            <div>
              <h2>Session History</h2>
              <p class="history-subtitle">Browse, filter, and revisit everything you've loggedâ€”your most recent sessions live here now.</p>
            </div>
            <div class="history-filters">
              <label>
                Subject
                <select id="history-subject-filter">
                  <option value="all">All subjects</option>
                </select>
              </label>
              <label>
                From
                <input type="date" id="history-start-date" />
              </label>
              <label>
                To
                <input type="date" id="history-end-date" />
              </label>
              <button type="button" id="history-clear-filters" class="secondary">Reset</button>
            </div>
          </div>

          <div class="history-meta">
            <p id="history-count" class="history-count">Showing 0 sessions</p>
            <p class="history-sort-hint">Sorted newest to oldest.</p>
          </div>

          <ul id="history-list" class="sessions-list history-sessions">
            <li class="history-empty-card">No sessions yet.</li>
          </ul>
        </section>
      </section>

      <section class="view" data-view="trends" aria-label="Study Trends">
        <section class="card chart-card">
          <div class="chart-header">
            <h2 id="charts-title">Study Trends</h2>
            <p class="chart-subtitle">Visualize your focus across subjects and days.</p>
          </div>
          <div class="chart-container">
            <h3>Time Spent per Subject</h3>
            <canvas id="subject-chart" height="200"></canvas>
          </div>
          <div class="chart-container">
            <h3>Last 14 Days</h3>
            <canvas id="trend-chart" height="200"></canvas>
          </div>
        </section>
        <section class="card card-content" aria-labelledby="summary-title">
          <h2 id="summary-title">Progress Summary</h2>
          <div class="summary-grid">
            <div class="summary-metric">
              <span class="summary-label">Total Minutes</span>
              <span class="summary-value" id="total-minutes">0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">Sessions Logged</span>
              <span class="summary-value" id="session-count">0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">Average / Session</span>
              <span class="summary-value" id="average-minutes">0.0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">Today</span>
              <span class="summary-value" id="today-minutes">0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">This Week</span>
              <span class="summary-value" id="week-minutes">0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">This Month</span>
              <span class="summary-value" id="month-minutes">0</span>
            </div>
            <div class="summary-metric">
              <span class="summary-label">Current Streak</span>
              <span class="summary-value" id="streak-days">0</span>
            </div>
          </div>
          <div class="summary-list">
            <h3>Subject Breakdown</h3>
            <div id="subject-breakdown" class="subject-breakdown"></div>
          </div>
        </section>
      </section>
    </main>

    <datalist id="subjects"></datalist>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="assets/js/app.js"></script>
  </body>
</html>
